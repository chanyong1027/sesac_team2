spring:
  application:
    name: LLM_Ops

  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 0
    validate-on-migrate: true

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: never

server:
  port: 8080

rag:
  context:
    max-chunks: 10
    max-context-chars: 4000
    include-source: true
    include-score: false
    separator: "\n\n---\n\n"
    truncated-marker: "[TRUNCATED]"
  chunking:
    chunk-size: 500
    min-chunk-size-chars: 200
    min-chunk-length-to-embed: 80
    max-num-chunks: 10000
    keep-separator: true
    chunk-overlap-tokens: 50
    paragraph-max-chars: 2000
  embedding:
    openai:
      enabled: false
      api-key: ${RAG_EMBEDDING_OPENAI_API_KEY:}
      base-url: ${RAG_EMBEDDING_OPENAI_BASE_URL:}
      model: text-embedding-3-small
      dimensions: 1536
    google-genai:
      enabled: false
      api-key: ${RAG_EMBEDDING_GOOGLE_GENAI_API_KEY:}
      model: text-embedding-004
  vectorstore:
    pgvector:
      enabled: false
      schema-name: public
      table-name: doc_chunks_v2
      initialize-schema: false
      dimensions: 1536
      distance-type: COSINE_DISTANCE
      index-type: HNSW
      max-document-batch-size: 10000
  search:
    top-k: 5
    similarity-threshold: 0.0
  hybrid:
    enabled: true
    vector-top-k: 20
    keyword-top-k: 20
    candidate-top-k: 30
    rrf-k: 60
    min-keyword-query-length: 3
  rerank:
    cohere:
      enabled: false
      api-key:
      base-url: https://api.cohere.com
      model: rerank-v3.5
      max-documents: 30
      top-n: 10
      client-name: luminaops

prompt:
  model-allowlist:
    openai:
      - gpt-4o-mini
      - gpt-4o
      - gpt-4.1-mini
      - gpt-4.1
      - gpt-4.1-nano
      - gpt-4
      - gpt-3.5-turbo
    anthropic:
      - claude-3-haiku-20240307
      - claude-3-haiku
      - claude-3-5-haiku
      - claude-3-5-sonnet
      - claude-3-opus
      - claude-3-sonnet
    gemini:
      - gemini-2.5-flash
      - gemini-2.5-flash-lite
      - gemini-2.0-flash

storage:
  s3:
    enabled: ${STORAGE_S3_ENABLED}
    endpoint: ${STORAGE_S3_ENDPOINT}
    bucket: ${STORAGE_S3_BUCKET}
    access-key: ${STORAGE_S3_ACCESS_KEY}
    secret-key: ${STORAGE_S3_SECRET_KEY}
    path-style-access: ${STORAGE_S3_PATH_STYLE_ACCESS}

jwt:
  secret: ${JWT_SECRET}
  expiration-sec: ${JWT_EXPIRATION:900}
  refresh-expiration-sec: 1209600

gateway:
  reliability:
    request-timeout-ms: 20000
    retry-backoff-ms: 200
    min-retry-budget-ms: 1200
    min-failover-budget-ms: 1200
